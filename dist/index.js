!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self)["wcasg-extensions"]=t()}(this,(function(){"use strict";var e="wcasg-extensions";class t{static debug(t){console.debug(`[${e}]: ${t}`)}static info(t){console.info(`[${e}]: ${t}`)}static log(t){console.log(`[${e}]: ${t}`)}static warn(t){console.warn(`[${e}]: ${t}`)}}class n{constructor(e){this.description="",this.enabled=!0,this.name="",this.action=e.action,this.description=e.description,this.enabled=void 0===e.enabled||e.enabled,this.name=e.name?e.name:"",this.predicate=e.predicate}predicatesPassed(){if(!this.predicate)return!1;if(Array.isArray(this.predicate)){for(const e of this.predicate)if(!e.passedAt)return t.log(`  Predicate '${e.name}' failed.`),!1}else if(!this.predicate.passedAt)return t.log(`  Predicate '${this.predicate.name}' failed.`),!1;return!0}execute(){if(this.runPredicates(),this.predicatesPassed())return this.firedAt=null,t.log("  Predicates passed, running actions."),this.runActions(),this.firedAt=new Date,this.firedAt;t.warn("  Predicate(s) failed, cancelling.")}runActions(){return!!this.action&&(Array.isArray(this.action)?this.action.forEach(e=>{e.run()}):this.action.run(),!0)}runPredicates(){return!!this.predicate&&(Array.isArray(this.predicate)?this.predicate.forEach(e=>{e.run()}):this.predicate.run(),!0)}toJson(){return JSON.stringify(this.toObject())}toObject(){let e=[],t=[];this.action&&(Array.isArray(this.action)?e=this.action.map(e=>e.toJson()):e.push(this.action.toJson())),this.predicate&&(Array.isArray(this.predicate)?t=this.predicate.map(e=>e.toJson()):t.push(this.predicate.toJson()));let n={description:this.description,enabled:this.enabled,firedAt:this.firedAt,name:this.name};return e.length>0&&(n.action=e),t.length>0&&(n.predicate=t),n}toString(){return JSON.stringify(this.toObject())}}var s=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function r(e,t){if(!s[e]){s[e]={};for(var n=0;n<e.length;n++)s[e][e.charAt(n)]=n}return s[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(n){return r(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),s=0,r=t.length;s<r;s++){var i=t.charCodeAt(s);n[2*s]=i>>>8,n[2*s+1]=i%256}return n},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var n=new Array(t.length/2),s=0,r=n.length;s<r;s++)n[s]=256*t[2*s]+t[2*s+1];var i=[];return n.forEach((function(t){i.push(e(t))})),o.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return r(n,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var s,r,o,i={},a={},c="",l="",u="",p=2,d=3,h=2,f=[],m=0,y=0;for(o=0;o<e.length;o+=1)if(c=e.charAt(o),Object.prototype.hasOwnProperty.call(i,c)||(i[c]=d++,a[c]=!0),l=u+c,Object.prototype.hasOwnProperty.call(i,l))u=l;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(s=0;s<h;s++)m<<=1,y==t-1?(y=0,f.push(n(m)),m=0):y++;for(r=u.charCodeAt(0),s=0;s<8;s++)m=m<<1|1&r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r>>=1}else{for(r=1,s=0;s<h;s++)m=m<<1|r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r=0;for(r=u.charCodeAt(0),s=0;s<16;s++)m=m<<1|1&r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r>>=1}0==--p&&(p=Math.pow(2,h),h++),delete a[u]}else for(r=i[u],s=0;s<h;s++)m=m<<1|1&r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r>>=1;0==--p&&(p=Math.pow(2,h),h++),i[l]=d++,u=String(c)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(s=0;s<h;s++)m<<=1,y==t-1?(y=0,f.push(n(m)),m=0):y++;for(r=u.charCodeAt(0),s=0;s<8;s++)m=m<<1|1&r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r>>=1}else{for(r=1,s=0;s<h;s++)m=m<<1|r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r=0;for(r=u.charCodeAt(0),s=0;s<16;s++)m=m<<1|1&r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r>>=1}0==--p&&(p=Math.pow(2,h),h++),delete a[u]}else for(r=i[u],s=0;s<h;s++)m=m<<1|1&r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r>>=1;0==--p&&(p=Math.pow(2,h),h++)}for(r=2,s=0;s<h;s++)m=m<<1|1&r,y==t-1?(y=0,f.push(n(m)),m=0):y++,r>>=1;for(;;){if(m<<=1,y==t-1){f.push(n(m));break}y++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,s){var r,o,i,a,c,l,u,p=[],d=4,h=4,f=3,m="",y=[],b={val:s(0),position:n,index:1};for(r=0;r<3;r+=1)p[r]=r;for(i=0,c=Math.pow(2,2),l=1;l!=c;)a=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=s(b.index++)),i|=(a>0?1:0)*l,l<<=1;switch(i){case 0:for(i=0,c=Math.pow(2,8),l=1;l!=c;)a=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=s(b.index++)),i|=(a>0?1:0)*l,l<<=1;u=e(i);break;case 1:for(i=0,c=Math.pow(2,16),l=1;l!=c;)a=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=s(b.index++)),i|=(a>0?1:0)*l,l<<=1;u=e(i);break;case 2:return""}for(p[3]=u,o=u,y.push(u);;){if(b.index>t)return"";for(i=0,c=Math.pow(2,f),l=1;l!=c;)a=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=s(b.index++)),i|=(a>0?1:0)*l,l<<=1;switch(u=i){case 0:for(i=0,c=Math.pow(2,8),l=1;l!=c;)a=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=s(b.index++)),i|=(a>0?1:0)*l,l<<=1;p[h++]=e(i),u=h-1,d--;break;case 1:for(i=0,c=Math.pow(2,16),l=1;l!=c;)a=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=s(b.index++)),i|=(a>0?1:0)*l,l<<=1;p[h++]=e(i),u=h-1,d--;break;case 2:return y.join("")}if(0==d&&(d=Math.pow(2,f),f++),p[u])m=p[u];else{if(u!==h)return null;m=o+o.charAt(0)}y.push(m),p[h++]=o+m.charAt(0),o=m,0==--d&&(d=Math.pow(2,f),f++)}}};return o}();null!=e&&(e.exports=t)}));class r{constructor(e){this.name="",this.fn=e.fn,this.name=e.name?e.name:""}run(){if(this.fn&&(this.passedAt=null,this.fn()))return this.passedAt=new Date,this.passedAt}toJson(){const e={name:this.name,passedAt:this.passedAt};return this.fn&&(e.fn=s.compressToBase64(String(this.fn))),e}}const o=e=>new Date(e+" UTC");class i{constructor(e){this.name="",this.fn=e.fn,this.name=e.name?e.name:""}run(){return!!this.fn&&(t.log(`  Running '${this.name}' action.`),this.fn(),!0)}toJson(){const e={name:this.name};return this.fn&&(e.fn=s.compressToBase64(String(this.fn))),e}}class a{constructor(e){this._extensions=[],this._imports=[],this._extensions=e.extensions}get extensions(){return this._extensions}get imports(){return this._imports}set imports(e){this._imports=e}add(e){this.extensions.push(e)}addImports(e){this.imports=e}processCustomImports(){this.imports.forEach(({name:e,description:a,enabled:c,pivot:l,actions:u,predicates:p})=>{const{enabled_at:d}=l;let h=!1;d&&(h=d&&o(d)<=new Date),t.log(`Importing '${e}' extension.`);const f=[];u&&u.forEach(e=>{let t=s.decompressFromBase64(e.function);"function"!=typeof t&&(t.trim().startsWith("function")&&(t=t.substring(t.indexOf("{")+1,t.lastIndexOf("}"))),t=Function(t)),f.push(new i({fn:t,name:e.name}))});const m=[];p&&p.forEach(e=>{let t=s.decompressFromBase64(e.function);"function"!=typeof t&&(t.trim().startsWith("function")&&(t=t.substring(t.indexOf("{")+1,t.lastIndexOf("}"))),t=Function(t));const n=new r({fn:t,name:e.name});m.push(n)});const y=this.extensions.find(t=>t.name===e);if(y)y.action=f,y.description=a,y.enabled=h,y.predicate=m;else{const t=new n({action:f,description:a,enabled:h,name:e,predicate:m});this.add(t)}})}processBuiltInImports(){this.imports.filter(e=>!0===e.imported).forEach(({name:e,pivot:n})=>{const{enabled_at:s}=n;let r=!1;s&&(r=s&&o(s)<=new Date);const i=this.extensions.find(t=>t.name===e);i&&i.enabled!==r&&(t.log(`${r?"Enabling":"Disabling"} built-in '${i.name}' extension (site override).`),i.enabled=r)})}executeExtensions(){this.extensions.filter(e=>e.enabled).forEach((e,n)=>{t.log(`Executing '${e.name?e.name:n}' extension.`),e.execute()})}}const c=new i({fn:()=>{const e=({node:e,name:t,type:n})=>{if("attribute"===n)return e.getAttribute(t);if("property"===n)return e[t];if("style"===n){const n=e.style.getPropertyValue(t);return n&&""!==n?n:window.getComputedStyle(e).getPropertyValue(t)}return""},t=({element:n,maxLength:s})=>{if(!n)return"";const r=[],o=e({node:n,name:"aria-label",type:"attribute"});o&&r.push(o);const i=e({node:n,name:"aria-labelledby",type:"attribute"});if(i&&document.getElementById(i)){const e=t({element:document.getElementById(i),maxLength:s});e&&r.push(e)}const a=e({node:n,name:"aria-valuetext",type:"attribute"});a&&r.push(a);const c=e({node:n,name:"alt",type:"attribute"});c&&r.push(c);const l=n.textContent;l&&r.push(l);const u=n.href;return u&&r.push(u),r.length>0?String(r[0]).substring(0,s):""},n=document.querySelectorAll(["button","label","input","select","textarea","legend","span","a","h1","h2","h3","h4","h5","h6"].join(", "));n&&0!==n.length&&n.forEach(e=>{if(e.getAttribute("aria-label"))return;(({node:e,name:t,type:n,value:s,priority:r})=>{"attribute"===n&&e.setAttribute(t,s),"property"===n&&(e[t]=s),"style"===n&&e.style.setProperty(t,s,r)})({node:e,type:"attribute",name:"aria-label",value:t({element:e})})})},name:"Add Aria Labels"}),l=new r({fn:()=>{const e=document.querySelectorAll('meta[content^="WordPress"]');return!(!e||!e[0])&&!!e[0]},name:"Has Wordpress"}),u=new n({action:c,description:"Adds missing 'aria-label' attributes with most relevant text value to all buttons, labels, and primary text elements.",name:"Add Missing Aria Labels",predicate:[l]}),p=new i({fn:()=>{const e=({node:n,name:s})=>{n instanceof NodeList?n.forEach(t=>e({node:t,name:s})):Array.isArray(s)?s.forEach(t=>e({node:n,name:t})):n.classList?n.classList.add(s):t({node:n,name:s})||(n.className+=" "+s)},t=({node:e,name:t})=>e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)")),n=document.querySelectorAll(["button","label","input","span","a","h1","h2","h3","h4","h5","h6"].join(", "));n&&0!==n.length&&n.forEach(n=>{t({node:n,name:"sr-only"})||e({node:n,name:"sr-only"}),t({node:n,name:"sr-only-focusable"})||e({node:n,name:"sr-only-focusable"})})},name:"Add Sr Classes"}),d=new r({fn:()=>!!window.bootstrap,name:"Has Bootstrap"}),h=new n({action:p,description:"Adds 'sr-only' and 'sr-only-focusable' attributes to all buttons, labels, and primary text elements.",enabled:!1,name:"Add Screen Reader Only Classes",predicate:[d]}),f=new i({fn:()=>{window.jQuery&&window.jQuery.fx&&(window.jQuery.fx.off=!0)},name:"Disable jQuery Fx"}),m=new r({fn:()=>!!window.jQuery,name:"Has jQuery"}),y=new n({action:f,description:"Disables all jQuery animations.",name:"Disable jQuery Animations",predicate:m});return{manager:new a({extensions:[u,h,y]})}}));
//# sourceMappingURL=index.js.map
